{{define "index"}}
<html>

<head>
  <meta charset="utf-8" />
  <title>Call Python Function</title>
</head>

<body>
  <p id="input"></p>
  <button onclick="call()">Call</button>
  <p id="output"></p>
  <script>
    const params = {
      current_time: 0,
      current_temperature: 0,
      battery_state_of_charge: 0,
      current_hvac_mode: "auto",
      current_heating_setpoint: 0,
      current_cooling_setpoint: 0,
      time_of_new_setpoint: 0,
      new_hvac_mode: "heat",
      new_heating_setpoint: 0,
      new_cooling_setpoint: 0,
      final_time: 0,
      num_time_steps: 2,
      num_samples: 5,
    };
    document.getElementById("input").innerHTML = JSON.stringify(params);
    const socket = new WebSocket("ws://localhost:9999/ws/cdcm");

    // Connection opened
    socket.addEventListener("open", (event) => {
      console.log("Connected");
    });

    // Listen for messages
    socket.addEventListener("message", (event) => {
      console.log("Message from server", event.data);
      document.getElementById("output").innerHTML = event.data;
    });

    function call() {
      socket.send(JSON.stringify(params));
    }
  </script>
</body>

</html>
{{end}}