function [Bmap2, HIEM2SMM]=HIEM2SMM_mapping_Init

%SMM Nodal Points
Xex_SMM = [0;0;2.5;-2.5;0;0;1.76776695;1.76776695;-1.76776695;-1.76776695;0;-1.76776695;1.76776695;1.43881643;-1.45326519;-1.43882525;1.45327044];
Yex_SMM = [0;2.5;0;0;0;1.76776695;1.76776695;0;1.76776695;0;1.76776695;0;0;1.43801594;1.43797874;1.43798959;1.43797982];
Zex_SMM = [2.5;0;0;0;-2.5;1.76776695;0;1.76776695;0;1.76776695;-1.76776695;-1.76776695;-1.76776695;1.45324361;1.43883193;-1.45326114;-1.43882561];

% HIEM_EN112
Xex_HIEM_unrot = [-0.400335357;-0.427111223;-1.000331663;-1.106535197;-1.191996857;0.399117634;0.424516231;0.997977487;1.10331601;1.186484576;-0.425756931;-1.190424413;-0.397799045;-1.104461506;0.424302414;0.399514876;1.186416775;1.105524653;1.005382762];
Yex_HIEM_unrot = [-1.007270664;-0.348688915;-1.443086981;-0.954992748;-0.332794987;-1.007933728;-0.348882563;-1.443863705;-0.955480106;-0.332794316;0.34933348;0.335112684;1.014144288;0.966822826;0.349101424;1.009676398;0.332365535;0.953730473;1.43986103];
Zex_HIEM_unrot = [1.773482054;1.947170794;1.365422666;1.563938171;1.698159381;1.77341774;1.948005556;1.36548841;1.565387428;1.700407729;1.94848703;1.698157148;1.769610064;1.555096732;1.949017555;1.772040279;1.700606466;1.564400987;1.362650737];

Nodes=[Xex_HIEM_unrot, Yex_HIEM_unrot, Zex_HIEM_unrot];
RMx=[1 0 0; 0 cos(+90/180*pi) -sin(+90/180*pi); 0 sin(+90/180*pi) cos(+90/180*pi)]; % rotation matrix
Nodes_Rotated=zeros(size(Nodes,1),size(Nodes,2));
for i=1:size(Nodes,1)
    Nodes_Rotated(i,:)=Nodes(i,:)*RMx; % Rotation matrix w.r.t x-axis by Seungwook
end

HIEMxyz=Nodes_Rotated; %Updated rotated XYZ coordinate of HIEM model%
Xex_HIEM_rot=HIEMxyz(:,1);
Yex_HIEM_rot=HIEMxyz(:,2);
Zex_HIEM_rot=HIEMxyz(:,3);

SMMxyz = [Xex_SMM Yex_SMM Zex_SMM];
HIEMxyz = [Xex_HIEM_rot Yex_HIEM_rot Zex_HIEM_rot];

%% mapping to SMM
HIEM2SMM = zeros(size(Xex_SMM,1),1);

for i=1:size(Xex_SMM,1)
    dxyz = nan(size(Xex_HIEM_rot,1),1);
    for j=1:size(Xex_HIEM_rot,1)
        dxyz_Tmp = [SMMxyz(i,:) ; HIEMxyz(j,:)];
        dxyz(j,1) = pdist(dxyz_Tmp,'euclidean');
    end
    [a,b] = min(dxyz);
    Bmap2(i)=b;
end

end