function [HIEMDamageNodes, HIEMDamageElements] = SMM2HIEM_mapping_Init

%SMM Nodal Points
% Xex_SMM = [0;0;2.5;-2.5;0;0;1.76776695;1.76776695;-1.76776695;-1.76776695;0;-1.76776695;1.76776695;1.43881643;-1.45326519;-1.43882525;1.45327044];
% Yex_SMM = [0;2.5;0;0;0;1.76776695;1.76776695;0;1.76776695;0;1.76776695;0;0;1.43801594;1.43797874;1.43798959;1.43797982];
% Zex_SMM = [2.5;0;0;0;-2.5;1.76776695;0;1.76776695;0;1.76776695;-1.76776695;-1.76776695;-1.76776695;1.45324361;1.43883193;-1.45326114;-1.43882561];

% SMM Gauss Points
SMMGP = [1.57773796336167,1.87418493207300,0.185270642439453;0.212969190614532,2.41583168045418,0.213221548461420;1.34756793866235,1.57837928930395,1.35921367218701;0.183734251153680,1.87418493207300,1.57927435464744;1.83408894502092,2.25216347162989,0.272408561799612;0.303176204659551,2.85975549573877,0.303753617319613;1.57586641628374,1.92030925944900,1.58933610751203;0.270378189344910,2.25216347162989,1.83611931747562;0.895962653807759,2.14642788654225,0.199857943775460;1.46326202783167,1.72770169096713,0.772854005638253;0.198960797703765,2.14642788654225,0.896859799879454;0.766260171727671,1.72770169096713,1.46985586174225;1.71310660611980,2.07993933933409,0.236065485320204;0.265265849565542,2.65455872557912,0.265713466091189;1.46891032940154,1.76610941185912,1.48150077305019;0.234249372177796,2.07993933933409,1.71492271926220;1.10638676877067,2.64395348938332,0.326007077831304;1.74273187458276,2.17423037123844,0.968798322927511;0.324531390932660,2.64395348938332,1.10786245566931;0.960876496744753,2.17423037123844,1.75065370076552;0.831111412767715,1.93706478875469,0.834856902758854;1.00117471128921,2.39519068796279,0.262932510803382;1.60299695120721,1.95096603110279,0.870826164282882;0.261746094318212,2.39519068796279,1.00236112777438;0.863568334236212,1.95096603110279,1.61025478125388;1.03363163275771,2.40909193031088,1.03833038929841;0.932371522762712,2.17307835953279,0.936593646028632;2.41583358331095,0.212949999013160,0.213216334130503;1.87425807963995,1.57764752705012,0.185265428108537;1.87425807963995,0.183643814842130,1.57926914031653;1.57901335462903,1.34691658459266,1.35920845785609;2.85971996238396,0.303115184402876,0.303724496496036;2.25220855790269,1.83394730513664,0.272379440976034;2.25220855790269,0.270236549460633,1.83609019665204;1.92098907327789,1.57509004884337,1.58930698668845;2.14646505387313,0.895907466617985,0.199852508938548;2.14646505387313,0.198905610513991,0.896854365042542;1.72805493953217,1.46289075940774,0.772848570801341;1.72805493953217,0.765888903303743,1.46985042690534;2.65453768378239,0.265221335778858,0.265693694354535;2.07999422970625,1.71298616016422,0.236045713583551;2.07999422970625,0.234128926222222,1.71490294752555;1.76676212488839,1.46819206078886,1.48148100131353;2.64393608225665,1.10626230348567,0.325964288738205;2.64393608225665,0.324406925647667,1.10781966657621;2.17457063770361,1.74224973570592,0.968755533834412;2.17457063770361,0.960394357867914,1.75061091167242;1.93725999670265,0.830898184960864,0.834851467921941;2.39520056806489,1.00108488505183,0.262908398838376;2.39520056806489,0.261656268080829,1.00233701580938;1.95131278861789,1.60257024755683,0.870802052317876;1.95131278861789,0.863141630585829,1.61023066928888;2.40925335998013,1.03332833067679,1.03828760020531;2.17325667834139,0.932113257818829,0.936569534063626;1.34746931949993,1.34682317973077,1.59044086136633;0.183635631991262,1.57755412218823,1.87557624413837;1.57763934419925,0.183550409980237,1.87557624413837;0.212870571452114,0.212856594151267,2.41586771437049;1.57531565123331,1.57456840444679,1.93324001873107;0.269827424294482,1.83342566074007,2.25302018458228;1.83353817997049,0.269714905064055,2.25302018458228;0.302625439609123,0.302593540006297,2.85907862926891;0.766157382113288,1.46279340459859,1.73442131818182;1.46315923821728,0.765791548494595,1.73442131818182;0.198858008089381,0.895810111808837,2.14713474468390;0.895859864193376,0.198808255704843,2.14713474468390;1.46853638456766,1.46783788757639,1.77852509466944;0.233875427343916,1.71263198695176,2.08098286898106;1.71273266128592,0.233774753009758,2.08098286898106;0.264891904731662,0.264867162566394,2.65415782644044;0.960067222345085,1.74148325014996,2.18070168258183;1.74192260018309,0.959627872311953,2.18070168258183;0.323722116532991,1.10549581792971,2.64362098785075;1.10557749437100,0.323640440091705,2.64362098785075;0.831008623153332,0.830800830151716,1.94077803143286;0.863112302229186,1.60213832737427,1.95756150038182;1.60254091920019,0.862709710403274,1.95756150038182;0.261290062311186,1.00065296486927,2.39537786626732;1.00071867928219,0.261224347898274,2.39537786626732;1.03282235835804,1.03256184512083,2.41216133521629;0.931915490755686,0.931681337636274,2.17646968332457;-0.185273182696771,1.87418153380073,1.57773985463069;-0.213222168438263,2.41583159290697,0.212969702996883;-1.35923133103230,1.57834982531432,1.34758068606394;-1.57927689490476,1.87418153380073,0.183736142422700;-0.272412950165893,2.25216138235882,1.83409246858865;-0.303755835209268,2.85975715199310,0.303178172174690;-1.58935758428923,1.92027768122775,1.57588219083164;-1.83612370584190,2.25216138235882,0.270381712912641;-0.199859538295426,2.14642616030029,0.895963868817378;-0.772864119592446,1.72768527650396,1.46326936035090;-0.896861394399420,2.14642616030029,0.198962012713383;-1.46986597569644,1.72768527650396,0.766267504246910;-0.236069119729004,2.07993679240765,1.71310946923944;-0.265715055121437,2.65455970677791,0.265267245215555;-1.48152051095844,1.76607908759891,1.46892474607755;-1.71492635367100,2.07993679240765,0.234252235297439;-0.326011273735509,2.64395430604275,1.10639033153046;-0.968812148275489,2.17421457066008,1.74274234085894;-1.10786665157351,2.64395430604275,0.324534953692459;-1.75066752611349,2.17421457066008,0.960886963020932;-0.834862756995933,1.93705571840212,0.831115686532144;-0.262935406015467,2.39519023317152,1.00117710017392;-0.870838133933967,1.95094992358202,1.60300585060492;-1.00236402298647,2.39519023317152,0.261748483202921;-1.61026675090497,1.95094992358202,0.863577233633921;-1.03833939992450,2.40908443835141,1.03363864727570;-0.936601078460217,2.17307007837677,0.932377166903921;-0.213216611204974,0.212949248749611,2.41583362163797;-0.185267625463482,1.57764346606151,1.87425949685363;-1.57927133767147,0.183639753853521,1.87425949685363;-1.35922577379901,1.34688645788670,1.57902562797528;-0.303724799355809,0.303113139540838,2.85971928241045;-0.272381914312434,1.83394151474921,2.25220943398177;-1.83609266998845,0.270230759073196,2.25220943398177;-1.58932654843577,1.57505476950574,1.92100220033714;-0.199853746055329,0.895905049634436,2.14646577478034;-0.896855602159323,0.198903193530441,2.14646577478034;-0.772858327352349,1.46287365420298,1.72806177794900;-1.46986018345634,0.765871798098988,1.72806177794900;-0.265693983165153,0.265219804085180,2.65453728190603;-0.236048047772719,1.71298110034531,2.07999529529953;-1.71490528171472,0.234123866403314,2.07999529529953;-1.48149943900215,1.46815922363618,1.76677474403803;-0.325965670766228,1.10625768185753,2.64393575489164;-1.10782104860423,0.324402304019526,2.64393575489164;-0.968766545306208,1.74222849683998,2.17457721385499;-1.75062192314421,0.960373119001979,2.17457721385499;-0.834856964755836,0.830888423866712,1.93726377636467;-0.262909708410779,1.00108136574598,2.39520076483599;-1.00233832538178,0.261652748774983,2.39520076483599;-0.870812436329278,1.60255107552148,1.95131949590199;-1.61024105330028,0.863122458550483,1.95131949590199;-1.03829379695522,1.03331540042976,2.40925648437331;-0.936575380855529,0.932101912148233,2.17326013036899;-2.41586776646573,0.212855805761765,0.212870702808276;-1.87557821651409,0.183546310865676,1.57764085444208;-1.87557821651409,1.57755002307366,0.183637142234093;-1.59045795233003,1.34679301489886,1.34748168587533;-2.85907767567213,0.302591282219695,0.302625279181752;-2.25302140146212,0.269708901752053,1.83353957559571;-2.25302140146212,1.83341965742806,0.269828819919703;-1.93325832402183,1.57453291218460,1.57532929783870;-2.14713574730743,0.198805798983053,0.895860682063797;-2.14713574730743,0.895807655087048,0.198858825959802;-1.73443084023958,0.765774403551600,1.46316617359732;-1.73443084023958,1.46277625965559,0.766164317493329;-2.65415726217326,0.264865486306460,0.264891855603891;-2.08098435009243,0.233769548624595,1.71273407962778;-2.08098435009243,1.71262678256659,0.233876845685775;-1.77854267928026,1.46780490585746,1.46854935646589;-2.64362052368660,0.323635505599851,1.10557793040844;-2.64362052368660,1.10549088343786,0.323722552570432;-2.18071084786145,0.959606320582304,1.74192993973691;-2.18071084786145,1.74146169842031,0.960074561898905;-1.94078329377351,0.830791029319324,0.831012499778563;-2.39537813549702,0.261220652291452,1.00071930623612;-2.39537813549702,1.00064926926245,0.261290689265117;-1.95757084405052,0.862690362066952,1.60254805666712;-1.95757084405052,1.60211897903795,0.863119439696117;-2.41216568577403,1.03254860201008,1.03282624615367;-2.17647448977377,0.931669815664702,0.931919372966117;-1.57773907192448,1.87418252448993,-0.185272679965504;-0.212969515145159,2.41583161772617,-0.213222026345209;-1.34757522000028,1.57835842040862,-1.35922798895511;-0.183735359716491,1.87418252448993,-1.57927639217349;-1.83409112925237,2.25216198971892,-0.272411980767252;-0.303177508161385,2.85975666500408,-0.303755275135659;-1.57587553460026,1.92028690452363,-1.58935339222776;-0.270380373576360,2.25216198971892,-1.83612273644326;-0.895963379254435,2.14642666316131,-0.199859212093281;-1.46326623168200,1.72769006450254,-0.772862193398230;-0.198961523150440,2.14642666316131,-0.896861068197276;-0.766264375578002,1.72769006450254,-1.46986404950222;-1.71310835762475,2.07993753364425,-0.236068338904619;-0.265266768689592,2.65455941790495,-0.265714659278675;-1.46891863433659,1.76608793900595,-1.48151669912967;-0.234251123682746,2.07993753364425,-1.71492557284662;-1.10638906430938,2.64395406292017,-0.326010274073686;-1.74273807752881,2.17421918267994,-0.968809332619737;-0.324533686471371,2.64395406292017,-1.10786565191169;-0.960882699690809,2.17421918267994,-1.75066471045774;-0.831113877416218,1.93705836383192,-0.834861630797753;-1.00117622178191,2.39519036304074,-0.262934743083484;-1.60300215460541,1.95095462359124,-0.870835763008984;-0.261747604810905,2.39519036304074,-1.00236336005448;-0.863573537634405,1.95095462359124,-1.61026437997998;-1.03363588200009,2.40908662280005,-1.03833749226571;-0.932374879708155,2.17307249331599,-0.936599561531734;-2.41583360519205,0.212949481762514,-0.213216583610234;-1.87425888555323,1.57764466494442,-0.185267237230529;-1.87425888555323,0.183640952736428,-1.57927094943852;-1.57902033331743,1.34689526117471,-1.35922254622013;-2.85971957565865,0.303113815265157,-0.303724878728614;-2.25220905190699,1.83394328482264,-0.272381584360207;-2.25220905190699,0.270232529146624,-1.83609234003622;-1.92099650136726,1.57506515551496,-1.58932299582072;-2.14646546387169,0.895905769493354,-0.199853539193455;-2.14646546387169,0.198903913389359,-0.896855395297449;-1.72805882793438,1.46287865919945,-0.772856520498404;-1.72805882793438,0.765876803095455,-1.46985837660240;-2.65453745531781,0.265220304642564,-0.265694021477903;-2.07999483362257,1.71298263101225,-0.236047701103847;-2.07999483362257,0.234125397070254,-1.71490493504585;-1.76676928223481,1.46816886447356,-1.48149606132890;-2.64393589423624,1.10625914718419,-0.325965610684017;-2.64393589423624,0.324403769346184,-1.10782098852202;-2.17457435709055,1.74223481730909,-0.968764669230068;-2.17457435709055,0.960379439471088,-1.75062004706807;-1.93726214590304,0.830891286294404,-0.834855957897927;-2.39520067905397,1.00108245833877,-0.262909574938736;-2.39520067905397,0.261653841367772,-1.00233819190974;-1.95131659251247,1.60255673825427,-0.870810594864236;-1.95131659251247,0.863128121283271,-1.61023921183524;-2.40925512566340,1.03331929332764,-1.03829282887605;-2.17325863578322,0.932105289811021,-0.936574393386986;-1.34747631679702,1.34680180067458,-1.59045474213041;-0.183636456513227,1.57755120444429,-1.87557784566040;-1.57764016872122,0.183547492236306,-1.87557784566040;-0.212870611941895,0.212856021262392,-2.41586775625026;-1.57532318324787,1.57454320039184,-1.93325486846591;-0.269828022223968,1.83342132969951,-2.25302116856902;-1.83353877789998,0.269710574023498,-2.25302116856902;-0.302625156808993,0.302591860142031,-2.85907785210406;-0.766161289911123,1.46278124639922,-1.73442905149984;-1.46316314601512,0.765779390295224,-1.73442905149984;-0.198858437483562,0.895808356693122,-2.14713555855976;-0.895860293587556,0.198806500589128,-2.14713555855976;-1.46854361247463,1.46781448029167,-1.77853936750581;-0.233876101820786,1.71262824683036,-2.08098406932236;-1.71273333576279,0.233771012888363,-2.08098406932236;-0.264891746827633,0.264865920460673,-2.65415736638481;-0.960071094435962,1.74146787518269,-2.18070911440051;-1.74192647227397,0.959612497344688,-2.18070911440051;-0.323722081216524,1.10549220505779,-2.64362060621959;-1.10557745905453,0.323636827219784,-2.64362060621959;-0.831010791749340,0.830793873494173,-1.94078230502980;-0.863116192173543,1.60212456079096,-1.95756908295018;-1.60254480914454,0.862695943819956,-1.95756908295018;-0.261290259350043,1.00065028087546,-2.39537808238968;-1.00071887632104,0.261221663904456,-2.39537808238968;-1.03282427674525,1.03255235120124,-2.41216486031005;-0.931917534247293,0.931673112347706,-2.17647358266993;0.185273735680099,1.87418163204594,-1.57773917527037;0.213222253763638,2.41583159578875,-0.212969585883371;1.35923556594023,1.57835067436681,-1.34757558007019;1.57927744788809,1.87418163204594,-0.183735463062385;0.272413655977186,2.25216143872384,-1.83409154446035;0.303756009123055,2.85975710555641,-0.303177882647214;1.58936247779047,1.92027854696234,-1.57587627041840;1.83612441165320,2.25216143872384,-0.270380788784340;0.199859858180680,2.14642621039890,-0.895963469087271;0.772866514268974,1.72768574968793,-1.46326646618068;0.896861714284674,2.14642621039890,-0.198961612983276;1.46986837037297,1.72768574968793,-0.766264610076684;0.236069757758220,2.07993686422257,-1.71310864986063;0.265715193372924,2.65455967951025,-0.265267024260556;1.48152508379492,1.76607993950225,-1.46891921523956;1.71492699170022,2.07993686422257,-0.234251415918625;0.326011758903727,2.64395428219088,-1.10638963214558;0.968814993237433,2.17421500289385,-1.74273882603117;1.10786713674173,2.64395428219088,-0.324534254307574;1.75067037107544,2.17421500289385,-0.960883448193166;0.834864114276824,1.93705598004342,-0.831114039581977;0.262935808542203,2.39519024629489,-1.00117655061643;0.870840753753204,1.95095037629089,-1.60300264610593;1.00236442551320,2.39519024629489,-0.261747933645425;1.61026937072420,1.95095037629089,-0.863574029134925;1.03834106498958,2.40908464254236,-1.03363654016937;0.936602589633203,2.17307031129289,-0.932375289875675;0.213216744157898,0.212949307946787,-2.41583360616201;0.185268226074360,1.57764362062213,-1.87425891913088;1.57927193828235,0.183639908414136,-1.87425891913088;1.35923005633449,1.34688736325460,-1.57902062361909;0.303725239258371,0.303113407612541,-2.85971956050508;0.272382886112502,1.83394188562261,-2.25220907747557;1.83609364178851,0.270231129946603,-2.25220907747557;1.58933170792578,1.57505594974873,-1.92099684754600;0.199854115582228,0.895905158429942,-2.14646548098589;0.896855971686223,0.198903302325948,-2.14646548098589;0.772860771670523,1.46287418608385,-1.72805898971443;1.46986262777452,0.765872329979853,-1.72805898971443;0.265694302011119,0.265219990354653,-2.65453744634105;0.236048866396415,1.71298138569736,-2.07999486131073;1.71490610033841,0.234124151755359,-2.07999486131073;1.48150419243312,1.46816028907665,-1.76676959859005;0.325966546768805,1.10625812013301,-2.64393588955030;1.10782192460681,0.324402742295003,-2.64393588955030;0.968769781102510,1.74222939120110,-2.17457453307076;1.75062515894052,0.960374013363098,-2.17457453307076;0.834858371678373,0.830888744204897,-1.93726223535016;0.262910331175517,1.00108163928148,-2.39520068526809;1.00233894814652,0.261653022310475,-2.39520068526809;0.870815276386517,1.60255178864248,-1.95131676139259;1.61024389335752,0.863123171671475,-1.95131676139259;1.03829585285466,1.03331606674805,-2.40925521131053;0.936577112266517,0.932102405476475,-2.17325872333034;1.59046211369351,1.34679384523177,-1.34747655247391;1.87557869595297,1.57755010259930,-0.183636435466107;1.87557869595297,0.183546390391314,-1.57764014767410;2.41586777824666,0.212855789923964,-0.212870558287093;1.93326280679445,1.57453367337472,-1.57532322436000;2.25302169654479,1.83341960924860,-0.269827742725943;2.25302169654479,0.269708853572590,-1.83353849840195;2.85907743885730,0.302591131238528,-0.302624836588817;1.73443315826158,1.46277671332837,-0.766161394756403;1.73443315826158,0.765774857224374,-1.46316325086040;2.14713599053816,0.895807685674464,-0.198858397662996;2.14713599053816,0.198805829570469,-0.895860253766991;1.77854697325038,1.46780568677978,-1.46854372170329;2.08098470925528,1.71262678340048,-0.233875922382362;2.08098470925528,0.233769549458485,-1.71273315632436;2.65415712155838,0.264865388057779,-0.264891530724292;2.18071308931350,1.74146197704018,-0.960070822162247;2.18071308931350,0.959606599202174,-1.74192620000025;2.64362040534492,1.10549070597208,-0.323721628276654;2.64362040534492,0.323635328134079,-1.10557700611466;1.94078457439987,0.830791271449419,-0.831010824261697;1.95757312378754,1.60211934518427,-0.863116108459325;1.95757312378754,0.862690728213274,-1.60254472543033;2.39537819794154,1.00064919582327,-0.261290012969825;2.39537819794154,0.261220578852274,-1.00071862994082;2.41216674732921,1.03254865258713,-1.03282391413845;2.17647566086454,0.931669962018274,-0.931917369200075];

Xex_SMM = SMMGP(:,1);
Yex_SMM = SMMGP(:,2);
Zex_SMM = SMMGP(:,3);

% % HIEM_EN112
% Xex_HIEM_unrot = [-0.400335357;-0.427111223;-1.000331663;-1.106535197;-1.191996857;0.399117634;0.424516231;0.997977487;1.10331601;1.186484576;-0.425756931;-1.190424413;-0.397799045;-1.104461506;0.424302414;0.399514876;1.186416775;1.105524653;1.005382762];
% Yex_HIEM_unrot = [-1.007270664;-0.348688915;-1.443086981;-0.954992748;-0.332794987;-1.007933728;-0.348882563;-1.443863705;-0.955480106;-0.332794316;0.34933348;0.335112684;1.014144288;0.966822826;0.349101424;1.009676398;0.332365535;0.953730473;1.43986103];
% Zex_HIEM_unrot = [1.773482054;1.947170794;1.365422666;1.563938171;1.698159381;1.77341774;1.948005556;1.36548841;1.565387428;1.700407729;1.94848703;1.698157148;1.769610064;1.555096732;1.949017555;1.772040279;1.700606466;1.564400987;1.362650737];

% HIEM_EN112
Xex_HIEM_unrot = [-1.031321213;-0.374273315;-0.992938884;-0.374180816;-0.372558691;-0.400335357;-0.427111223;-1.000331663;-1.106535197;-1.191996857;-1.70044367;-1.948610396;-1.560300425;-1.771134109;-1.352136761;-1.481280162;1.03456854;0.375939019;0.99351266;0.374227405;1.947061791;1.770781874;1.483332395;1.697034776;1.558642045;1.35183978;0.371551521;0.399117634;0.424516231;0.997977487;1.10331601;1.186484576;-0.425756931;-1.190424413;-0.397799045;-1.104461506;-0.371766724;-1.001441203;-1.700452521;-1.949282765;-1.55997865;-1.769530952;-1.354277894;-1.477576913;-0.373312496;-0.375300467;-1.028932668;-0.996530293;0.372269094;1.030100525;0.374632142;1.000348204;1.481988551;1.771445603;1.948271274;1.361015993;1.5612406;1.696887925;0.424302414;0.399514876;0.373381779;1.186416775;1.105524653;1.005382762];
Yex_HIEM_unrot = [-1.896619544;-2.070022344;-1.730274305;-1.890119806;-1.547566921;-1.007270664;-0.348688915;-1.443086981;-0.954992748;-0.332794987;-0.333890967;-0.350082532;-0.958206302;-1.011868208;-1.448404848;-1.555789769;-1.892578855;-2.068297176;-1.728676528;-1.88969393;-0.348009765;-1.007706851;-1.551385658;-0.332028188;-0.955485739;-1.446375163;-1.548300117;-1.007933728;-0.348882563;-1.443863705;-0.955480106;-0.332794316;0.34933348;0.335112684;1.014144288;0.966822826;1.55975646;1.460714595;0.337151855;0.351754859;0.969804898;1.018518254;1.460975513;1.561668336;2.072217165;1.898076788;1.898441329;1.7394775;2.072217821;1.895183415;1.894294515;1.725711226;1.552737074;1.009884694;0.348793991;1.439209448;0.952546873;0.331675895;0.349101424;1.009676398;1.551737698;0.332365535;0.953730473;1.43986103;];
Zex_HIEM_unrot = [0.378484965;0.378428213;1.006702021;1.041591502;1.490418389;1.773482054;1.947170794;1.365422666;1.563938171;1.698159381;1.188140876;0.424950562;1.108522699;0.40107356;1.00952109;0.375864111;0.379221477;0.378805414;1.00707347;1.04151088;0.426776543;0.402129591;0.376874521;1.191380442;1.111092299;1.011334583;1.48968105;1.77341774;1.948005556;1.36548841;1.565387428;1.700407729;1.94848703;1.698157148;1.769610064;1.555096732;1.475874706;1.343885124;1.186165213;0.423279956;1.097254695;0.395492017;0.98987832;0.368297823;0.373084195;1.026892028;0.3726063;0.988125019;0.373231605;0.375509642;1.031181602;1.001709141;0.374881521;0.402066179;0.427447401;1.008566217;1.110702896;1.192251452;1.949017555;1.772040279;1.482536121;1.700606466;1.564400987;1.362650737];


Nodes=[Xex_HIEM_unrot, Yex_HIEM_unrot, Zex_HIEM_unrot];
RMx=[1 0 0; 0 cos(+90/180*pi) -sin(+90/180*pi); 0 sin(+90/180*pi) cos(+90/180*pi)]; % rotation matrix
Nodes_Rotated=zeros(size(Nodes,1),size(Nodes,2));
for i=1:size(Nodes,1)
    Nodes_Rotated(i,:)=Nodes(i,:)*RMx; % Rotation matrix w.r.t x-axis by Seungwook
end

HIEMxyz=Nodes_Rotated; %Updated rotated XYZ coordinate of HIEM model%
Xex_HIEM_rot=HIEMxyz(:,1);
Yex_HIEM_rot=HIEMxyz(:,2);
Zex_HIEM_rot=HIEMxyz(:,3);

SMMxyz = [Xex_SMM Yex_SMM Zex_SMM];
HIEMxyz = [Xex_HIEM_rot Yex_HIEM_rot Zex_HIEM_rot];

% P1 = DamageLocation;

%% mapping to HIEM - Gives Damaged SMM nodes
SMM2HIEM = zeros(size(Xex_HIEM_rot,1),1);

for i=1:size(Xex_HIEM_rot,1)
    dxyz = nan(size(Xex_SMM,1),1);
    for j=1:size(Xex_SMM,1)
        dxyz_Tmp = [HIEMxyz(i,:) ; SMMxyz(j,:)];
        dxyz(j,1) = pdist(dxyz_Tmp,'euclidean');
    end
    [a,b] = min(dxyz);
    SMM2HIEM(i) = b;
end

HIEMDamageNodes = SMM2HIEM;

%% mapping to HIEM - Gives Damaged HIEM Elements
SMM2HIEM_Elem = zeros(size(Xex_SMM,1),1);

for i=1:size(Xex_SMM,1)
    dxyz = nan(size(Xex_HIEM_rot,1),1);
    for j=1:size(Xex_HIEM_rot,1)
        dxyz_Tmp = [HIEMxyz(j,:) ; SMMxyz(i,:)];
        dxyz(j,1) = pdist(dxyz_Tmp,'euclidean');
    end
    [a,b] = min(dxyz);
    SMM2HIEM_Elem(i) = b;
end

HIEMDamageElements = SMM2HIEM_Elem(:);
end